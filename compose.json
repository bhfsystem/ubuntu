{
  "version": "2.1",
  "networks": {
    "default": {
      "ipam": {
        "config": [
          {
            "subnet": "${NET_SUBNET}.0/23",
            "gateway": "${NET_SUBNET}.1",
            "ip_range": "${NET_PREFIX}.0/24"
          }
        ]
      }
    }
  },
  "services": {
    "base": {
      "volumes": [
        "/data:/data",
        "/config:/config"
      ],
      "ports": [
        "${BLOCK_SSH_PORT}"
      ],
      "cap_add": [
        "NET_ADMIN"
      ],
      "networks": {
        "default": {
          "ipv4_address": "${NET_PREFIX}.100"
        }
      },
      "dns_search": "node.consul",
      "image": "${BLOCK_REGISTRY}/block:base",
      "hostname": "base"
    },
    "ubuntu": {
      "volumes": [
        "/data:/data",
        "/config:/config"
      ],
      "ports": [
        "${BLOCK_SSH_PORT}"
      ],
      "cap_add": [
        "NET_ADMIN"
      ],
      "networks": {
        "default": {
          "ipv4_address": "${NET_PREFIX}.101"
        }
      },
      "dns_search": "node.consul",
      "image": "${BLOCK_REGISTRY}/block:ubuntu",
      "hostname": "ubuntu"
    }
  }
}
